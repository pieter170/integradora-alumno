<ion-content [fullscreen]="true">
  <div class="app-container">

    <header class="app-header">
      <div class="header-icon">
        <ion-back-button defaultHref="/menu" text="" icon="arrow-back" class="back-button"></ion-back-button>
      </div>
      
      <h1>Mi Perfil</h1>
      
      <div class="header-icon"></div> 
    </header>

    <main class="content-area">

      <div class="profile-header">
        
        <img *ngIf="imagenPreview" 
             [src]="imagenPreview" 
             style="width: 120px; height: 120px; border-radius: 50%; object-fit: cover; margin-bottom: 10px; border: 4px solid #ddd;">

        <ion-icon *ngIf="!imagenPreview" 
                  name="person-circle-outline" 
                  style="font-size: 8rem; color: #ccc; margin-bottom: 10px;">
        </ion-icon>
        
        <h2>{{ user.username || 'Cargando...' }}</h2>
        <p>{{ user.email || 'cargando@email.com' }}</p>
      </div>

      <nav class="profile-menu" *ngIf="!editMode">
        <div class="menu-item" (click)="toggleEdit()">
          <span>Editar Datos Personales</span>
          <ion-icon name="chevron-forward-outline"></ion-icon>
        </div>
        <div class="menu-item" routerLink="/history">
          <span>Historial de Pedidos</span>
          <ion-icon name="chevron-forward-outline"></ion-icon>
      </div>
        <div class="menu-item logout" (click)="logout()">
          <span>Cerrar Sesión</span>
          <ion-icon name="log-out-outline"></ion-icon>
        </div>
      </nav>

      <div class="edit-form" *ngIf="editMode">
        <div class="form-group">
          <label>Nombre de usuario</label>
          <input type="text" [(ngModel)]="user.username" class="styled-input">
        </div>
        <div class="form-group">
          <label>Correo electrónico</label>
          <input type="email" [(ngModel)]="user.email" class="styled-input">
        </div>
        <div class="button-row">
          <button class="btn-cancel" (click)="toggleEdit()">Cancelar</button>
          <button class="btn-save" (click)="guardarCambios()">Guardar Cambios</button>
        </div>
      </div>

    </main>
  </div>
</ion-content>

<nav class="bottom-nav">
  <a routerLink="/menu" class="nav-item">
    <ion-icon name="fast-food-outline"></ion-icon>
    <span>Menú</span>
  </a>
  <a routerLink="/pedido" class="nav-item">
    <ion-icon name="cart-outline"></ion-icon>
    <span>Pedidos</span>
  </a>
  <a routerLink="/perfil" class="nav-item active">
    <ion-icon name="person-outline"></ion-icon>
    <span>Perfil</span>
  </a>
</nav>